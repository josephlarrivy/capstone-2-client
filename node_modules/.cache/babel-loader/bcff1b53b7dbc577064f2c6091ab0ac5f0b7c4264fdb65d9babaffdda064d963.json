{"ast":null,"code":"import _regeneratorRuntime from\"/Users/josephlarrivy/software-engineering/springboard/assignments/capstone-2-rework/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/josephlarrivy/software-engineering/springboard/assignments/capstone-2-rework/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/josephlarrivy/software-engineering/springboard/assignments/capstone-2-rework/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import useLocalStorage from\"../hooks/useLocalStorage\";import BackendApiRequest from\"../apis/backendApi\";import'../css/AddToTripDropdown.css';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddToTripDropdown=function AddToTripDropdown(_ref){var type=_ref.type,route=_ref.route,name=_ref.name,description=_ref.description,parkcode=_ref.parkcode,latitude=_ref.latitude,longitude=_ref.longitude;var _useLocalStorage=useLocalStorage(),_useLocalStorage2=_slicedToArray(_useLocalStorage,4),localStoreToken=_useLocalStorage2[0],localRemoveToken=_useLocalStorage2[1],localRetrieveToken=_useLocalStorage2[2],localDecodeToken=_useLocalStorage2[3];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedOption=_useState2[0],setSelectedOption=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),trips=_useState6[0],setTrips=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isOpen=_useState8[0],setIsOpen=_useState8[1];var navigate=useNavigate();useEffect(function(){var getUsername=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return localDecodeToken();case 2:token=_context.sent;setUsername(token.username);case 4:case\"end\":return _context.stop();}},_callee);}));return function getUsername(){return _ref2.apply(this,arguments);};}();getUsername();console.log('AddToTripDropdown loaded');},[]);useEffect(function(){var getTrips=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data,optionsArray;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!username){_context2.next=14;break;}_context2.prev=1;_context2.next=4;return BackendApiRequest.getUserTrips(username);case 4:data=_context2.sent;console.log(data);setTrips(data);optionsArray=data.map(function(item){return{id:item.id,tripname:item.tripname};});setSelectedOption(optionsArray);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);// Handle the error if the request fails\nconsole.error(_context2.t0);case 14:case\"end\":return _context2.stop();}},_callee2,null,[[1,11]]);}));return function getTrips(){return _ref3.apply(this,arguments);};}();getTrips();},[username]);var handleSelect=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e){var id,response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:id=e.target.value;_context3.next=3;return BackendApiRequest.addTripItem(type,route,name,description,parkcode,latitude,longitude,id);case 3:response=_context3.sent;setIsOpen(false);case 5:case\"end\":return _context3.stop();}},_callee3);}));return function handleSelect(_x){return _ref4.apply(this,arguments);};}();var toggleDropdown=function toggleDropdown(){setIsOpen(!isOpen);};return/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"dropdown-toggle\",type:\"button\",onClick:toggleDropdown,children:'Add to a trip itinerary'}),isOpen&&trips.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-menu\",children:selectedOption.map(function(option){return/*#__PURE__*/_jsx(\"button\",{className:\"dropdown-item\",value:option.id,onClick:function onClick(e){return handleSelect(e);},children:option.tripname},option.id);})}),isOpen&&trips.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-menu\",children:/*#__PURE__*/_jsx(\"button\",{className:\"dropdown-item\",onClick:function onClick(){return navigate('/myTrips');},children:\"Create a trip\"})})]});};export default AddToTripDropdown;","map":{"version":3,"names":["React","useEffect","useState","useLocalStorage","BackendApiRequest","useNavigate","jsx","_jsx","jsxs","_jsxs","AddToTripDropdown","_ref","type","route","name","description","parkcode","latitude","longitude","_useLocalStorage","_useLocalStorage2","_slicedToArray","localStoreToken","localRemoveToken","localRetrieveToken","localDecodeToken","_useState","_useState2","selectedOption","setSelectedOption","_useState3","_useState4","username","setUsername","_useState5","_useState6","trips","setTrips","_useState7","_useState8","isOpen","setIsOpen","navigate","getUsername","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","wrap","_callee$","_context","prev","next","sent","stop","apply","arguments","console","log","getTrips","_ref3","_callee2","data","optionsArray","_callee2$","_context2","getUserTrips","map","item","id","tripname","t0","error","handleSelect","_ref4","_callee3","e","response","_callee3$","_context3","target","value","addTripItem","_x","toggleDropdown","className","children","onClick","length","option"],"sources":["/Users/josephlarrivy/software-engineering/springboard/assignments/capstone-2-rework/client/src/components/AddToTripDropdown.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport useLocalStorage from \"../hooks/useLocalStorage\";\nimport BackendApiRequest from \"../apis/backendApi\";\n\nimport '../css/AddToTripDropdown.css'\nimport { useNavigate } from 'react-router-dom';\n\nconst AddToTripDropdown = ({ type, route, name, description, parkcode, latitude, longitude }) => {\n\n  const [localStoreToken, localRemoveToken, localRetrieveToken, localDecodeToken] = useLocalStorage()\n  const [selectedOption, setSelectedOption] = useState([]);\n  const [username, setUsername] = useState(null)\n  const [trips, setTrips] = useState([])\n  const [isOpen, setIsOpen] = useState(false);\n  const navigate = useNavigate()\n\n  useEffect(() => {\n    const getUsername = async () => {\n      const token = await localDecodeToken()\n      setUsername(token.username)\n    }\n    getUsername()\n    console.log('AddToTripDropdown loaded')\n  }, [])\n\n  useEffect(() => {\n    const getTrips = async () => {\n      if (username) { // Only fetch trips if username is available\n        try {\n          const data = await BackendApiRequest.getUserTrips(username);\n          console.log(data);\n          setTrips(data);\n\n          const optionsArray = data.map((item) => ({\n            id: item.id,\n            tripname: item.tripname,\n          }));\n          setSelectedOption(optionsArray);\n        } catch (error) {\n          // Handle the error if the request fails\n          console.error(error);\n        }\n      }\n    };\n\n    getTrips();\n  }, [username]);\n\n\n  const handleSelect = async (e) => {\n    const id = e.target.value\n    const response = await BackendApiRequest.addTripItem(type, route, name, description, parkcode, latitude, longitude, id)\n    setIsOpen(false);\n  };\n\n  const toggleDropdown = () => {\n    setIsOpen(!isOpen);\n  };\n\n  return (\n    <div className=\"dropdown\">\n      <button className=\"dropdown-toggle\" type=\"button\" onClick={toggleDropdown}>\n        {'Add to a trip itinerary'}\n      </button>\n      {isOpen && trips.length > 0 &&\n        <div className=\"dropdown-menu\">\n          {selectedOption.map((option) => (\n            <button className=\"dropdown-item\" key={option.id} value={option.id} onClick={(e) => handleSelect(e)}>\n              {option.tripname}\n            </button>\n          ))}\n        </div>\n        }\n      {isOpen && trips.length === 0 &&\n        <div className=\"dropdown-menu\">\n          <button className=\"dropdown-item\" onClick={() => navigate('/myTrips')}>\n            Create a trip\n          </button>\n        </div>\n      }\n    </div>\n  );\n};\n\nexport default AddToTripDropdown;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}